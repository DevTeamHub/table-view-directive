function dtTableViewController(a,b){a.skip=0,a.take=20,this.scope=a,a.currentPage||(a.currentPage=1),a.searchString="",this.filter=function(b,c){b&&(c=1),a.search({skip:a.take*(c-1),take:a.take,searchString:b}).then(function(b){a.count=b.Count,a.list=b.List})},this.search=function(b){this.filter(b,a.currentPage)},this.changePage=function(b){a.currentPage=b,this.filter(a.searchString,b)},this.add=function(b){return a.add({model:b}).then(function(){a.push?a.list.push(b):a.list.unshift(b)})},this.update=function(b){return a.update({model:b})},this.remove=function(b){return a.remove({model:b}).then(function(){var c=a.list.indexOf(b);a.list.splice(c,1)})},this.init=function(c){var d=a.initPopup({model:c});return d||(d=b.when()),d}}function dtTableViewDirective(){function a(a,b){return b.templateUrl?b.templateUrl:"dt-table-view.tmpl.html"}return{scope:{list:"=",count:"=",search:"&",add:"&",update:"&",remove:"&",initPopup:"&",addTemplate:"@",updateTemplate:"@",removeMessage:"@",push:"@",currentPage:"=?"},restrict:"E",replace:!0,transclude:!0,templateUrl:a,controller:["$scope","$q",dtTableViewController],controllerAs:"ctrl",link:function(a,b,c){if(a.canAdd=!!c.add,a.canUpdate=!!c.update,a.canRemove=!!c.remove,a.canSearch=!!c.search,!a.list)throw new Error("You should setup start values for list");if(a.canAdd&&!a.addTemplate)throw new Error("Cannot find add template");if(a.canUpdate&&!a.updateTemplate)throw new Error("Cannot find update template")}}}function dtActionButtonsController(a){this.update=function(b){return a.viewCtrl.update(b)},this.remove=function(b){return a.viewCtrl.remove(a.item)},this.init=function(b){return a.viewCtrl.init(b)}}function dtActionButtonsDirective(){function a(a,b){return b.templateUrl?b.templateUrl:"dt-action-buttons.tmpl.html"}return{scope:{item:"=dtActionButtons",canUpdate:"=?",canRemove:"=?"},restrict:"A",require:"^dtTableView",templateUrl:a,controller:["$scope",dtActionButtonsController],controllerAs:"ctrl",link:function(a,b,c,d){a.viewCtrl=d,a.updateTemplate=d.scope.updateTemplate,a.removeMessage=d.scope.removeMessage,void 0==a.canUpdate&&(a.canUpdate=!0),void 0==a.canRemove&&(a.canRemove=!0),d.scope.removeMessage||(a.removeMessage="Are you sure that you want to remove this item?")}}}var tableViewModule=angular.module("dev-team-table-view",[]);tableViewModule.directive("dtTableView",dtTableViewDirective).directive("dtActionButtons",dtActionButtonsDirective),tableViewModule.run(["$templateCache",function(a){a.put("dt-action-buttons.tmpl.html",'<span><dt-popup-link ng-if="viewCtrl.scope.canUpdate && canUpdate" class="btn link-button glyphicon glyphicon-edit"ng-model="item"init-action="ctrl.init(model)"save-action="ctrl.update(model)"url="updateTemplate"></dt-popup-link><dt-confirm-link ng-if="viewCtrl.scope.canRemove && canRemove" class="btn link-button glyphicon glyphicon-remove"confirm-action="ctrl.remove(model)"message="{{removeMessage}}"></dt-confirm-link></span>'),a.put("dt-table-view.tmpl.html",'<div class="ibox-content"><div class="row search-container"><div class="col-xs-6" ng-if="canSearch"><dt-search search-string="searchString" search="ctrl.search(searchString)"></dt-search></div><div class="col-xs-6" ng-class="{\'pull-right\': canSearch}" ng-if="canAdd"><dt-popup-link class="btn btn-sm btn-primary add-new-item-btn" url="addTemplate" save-action="ctrl.add(model)" init-action="ctrl.init(model)" title="Добавить"></dt-popup-link></div></div><br /><div ng-transclude></div><dt-pagination ng-if="canSearch" num-pages="count" max-pages="5" current-page="currentPage" on-select-page="ctrl.changePage(page)"></dt-pagination></div>')}]);
//# sourceMappingURL=table-view-directive.min.js.map